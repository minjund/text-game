import{d as e,b as s,w as t,q as a,k as o,u as l,f as r,j as c,l as d,v as n,y as i,p as m,F as f,m as p,T as u,z as b}from"./DvSjL5z3.js";import{u as x,a as v,b as g}from"./DjTCJ7Sd.js";import"./kkAUuAVg.js";const y={class:"parchment-content bg-gradient-to-r from-amber-900 to-amber-800 border-b-2 border-amber-600 p-3 sm:p-4 flex-shrink-0"},k={class:"text-lg sm:text-xl font-bold flex items-center gap-2"},w={class:"flex-1 overflow-y-auto p-3 sm:p-6"},h={class:"parchment-content text-slate-300 text-sm sm:text-base mb-4 sm:mb-6"},j={class:"space-y-3 sm:space-y-4"},_=["onClick","disabled"],R={class:"font-semibold mb-2"},C={class:"space-y-2 text-sm"},M={key:0,class:"flex flex-wrap gap-2"},O={key:0,class:"text-green-300"},T={key:1,class:"text-yellow-300"},z={key:2,class:"text-red-300"},E={key:1,class:"flex flex-wrap gap-2"},G={key:0,class:"text-green-300"},q={key:1,class:"text-yellow-300"},F={key:2,class:"text-red-300"},I={key:3,class:"text-pink-300"},A=e({__name:"GameEventModal",props:{event:{},currentResources:{}},emits:["close","select-choice"],setup(e,{emit:A}){const B=e,D=A,H=s(),J=s(),K=s([]),{openModal:L,closeModal:N}=v(),{unfold:P}=g(),{pulse:Q}=x();t(()=>B.event,async e=>{e&&H.value&&(await b(),L(H.value),setTimeout(()=>{J.value&&P(J.value)},300))},{immediate:!0});const S=()=>{H.value&&N(H.value,()=>{D("close")})},U=e=>!e.cost||(!B.currentResources||!(e.cost.food&&B.currentResources.food<e.cost.food)&&(!(e.cost.gold&&B.currentResources.gold<e.cost.gold)&&!(e.cost.soldiers&&B.currentResources.soldiers<e.cost.soldiers)));return(s,t)=>(o(),a(u,{name:"modal"},{default:l(()=>[e.event?(o(),r("div",{key:0,class:"fixed inset-0 bg-black/90 z-[10000] flex justify-center",onClick:S},[d("div",{ref_key:"modalRef",ref:H,class:"w-full max-w-md h-full flex flex-col bg-gradient-to-br from-slate-800 to-slate-900 border-2 border-amber-600 rounded-lg max-h-screen m-auto overflow-hidden",onClick:t[0]||(t[0]=n(()=>{},["stop"]))},[d("div",{ref_key:"parchmentRef",ref:J,class:"parchment-container flex-1 flex flex-col"},[d("div",y,[d("h2",k,[t[1]||(t[1]=d("span",null,"ðŸŽ´",-1)),i(" "+m(e.event.title),1)])]),d("div",w,[d("p",h,m(e.event.description),1),d("div",j,[(o(!0),r(f,null,p(e.event.choices,(e,s)=>(o(),r("button",{key:s,ref_for:!0,ref:e=>((e,s)=>{e&&(K.value[s]=e)})(e,s),onClick:n(s=>(e=>{if(U(e)){const s=B.event?.choices.findIndex(s=>s===e);void 0!==s&&s>=0&&K.value[s]&&Q(K.value[s]),setTimeout(()=>{D("select-choice",e)},200)}})(e),["stop"]),disabled:!U(e),class:"parchment-content w-full bg-slate-700/50 hover:bg-slate-600/50 active:bg-slate-500/50 disabled:bg-slate-800/50 disabled:opacity-50 disabled:cursor-not-allowed border-2 border-slate-600 hover:border-amber-500 disabled:border-slate-700 rounded-lg p-4 sm:p-5 text-left transition-all touch-manipulation text-base sm:text-lg"},[d("div",R,m(e.text),1),d("div",C,[e.cost&&Object.keys(e.cost).length>0?(o(),r("div",M,[t[2]||(t[2]=d("strong",{class:"text-red-400"},"ë¹„ìš©:",-1)),e.cost.food?(o(),r("span",O,"ðŸŒ¾ "+m(e.cost.food),1)):c("",!0),e.cost.gold?(o(),r("span",T,"ðŸ’° "+m(e.cost.gold),1)):c("",!0),e.cost.soldiers?(o(),r("span",z,"âš”ï¸ "+m(e.cost.soldiers),1)):c("",!0)])):c("",!0),e.reward&&Object.keys(e.reward).length>0?(o(),r("div",E,[t[3]||(t[3]=d("strong",{class:"text-green-400"},"ë³´ìƒ:",-1)),e.reward.food?(o(),r("span",G,"ðŸŒ¾ +"+m(e.reward.food),1)):c("",!0),e.reward.gold?(o(),r("span",q,"ðŸ’° +"+m(e.reward.gold),1)):c("",!0),e.reward.soldiers?(o(),r("span",F,"âš”ï¸ +"+m(e.reward.soldiers),1)):c("",!0),e.reward.morale?(o(),r("span",I,"â¤ï¸ "+m(e.reward.morale>0?"+":"")+m(e.reward.morale),1)):c("",!0)])):c("",!0)])],8,_))),128))])])],512)],512)])):c("",!0)]),_:1}))}}),B=Object.assign(A,{__name:"GameEventModal"});export{B as default};
